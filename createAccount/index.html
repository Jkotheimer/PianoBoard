<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Create New Account</title>
    <link rel="shortcut icon" href="../images/Icon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="accCreator.css">
    <link rel="stylesheet" href="../images/generalStyles.css">
    <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase-firestore.js"></script>
    <script type="text/javascript" src="../firebase/app.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
    <div id="logoBox" class="logoBox" onclick="window.location.href = '../';">
        <img src="../images/PBlogo.png" class="logo">
    </div>
    <div hidden id="header">
        <span id="label" >Create an Account</span>
        <br> <br>
            <label for="email">E-mail</label> <br>
            <input type="text" id="email" class="formInput" placeholder="your.email@something.com" 
                autocapitalize="off" autocomplete="off" spellcheck="false" autocorrect="off"
                name="email" required>
            <br>
            <div id="email_notification"></div>

            <label for="username">Username</label> <br>
            <input type="text" id="username" class="formInput" placeholder="Choose a username" 
                autocapitalize="off" autocomplete="off" spellcheck="false" autocorrect="off"
                name="username" required>
            <br>
            <div id="username_notification"></div>

            <label for="pass">Password</label> <br>
            <input type="password" id="pass" class="formInput" placeholder="Choose a password" name="password" minlength="8" 
                autocapitalize="off" autocomplete="off" spellcheck="false" autocorrect="off" required>
            <br>
            <div id="password_notification"></div>

            <label for="pass2">Confirm Password</label> <br>
            <input type="password" id="pass2" class="formInput" placeholder="Confirm Password" name="password2" minlength="8" 
                autocapitalize="off" autocomplete="off" spellcheck="false" autocorrect="off" required>
            <br>
            <div id="confirm_password_notification"></div>
            <button type="submit" id="submit" onclick="handleSignUp()">Create Account</button>
    </div>
    <div id="loader" class="loading_screen">
        While we prepare your account, tell us a little bit about yourself.
        <div id="genreSelector">
            <p id="g-title">What are your favorite music genres?</p>
            <input type="text" id="genres">
            <button onclick="grabSimilarGenres()">PRESS ME</button>
        </div>
        <div id="bandSelector">
            <div id="band_search_container">
                Who are your favorite bands/artists?
                <input type="text" id="artists" placeholder="ex: Eminem">
            </div>
            <div id="recommended_container">
                Based on your favorite genres, we think you might like these artists!
                <div id="recommendations">
                    Your recommendations will go here.
                </div>
            </div>
            <div id="selected_bands">
                The bands you select will go here.
            </div>
        </div>
    </div>
    <div id="footer"></div>
    <script type="text/javascript" src="../images/animations.js"></script>
    <script>
        // fun tip : &#x260A; creates a lil headphone emoji
        //var print = setInterval(function() {
            //document.getElementById("footer").innerHTML = "Width: " + $(window).width() + "<br>Height: " + $(window).height();
        //}, 10);
        document.addEventListener("keydown", function() {
            if(event.keyCode == 13) {
                event.preventDefault();
                document.getElementById("submit").click();
            }
        });
        var objects = new Map();
        objects.set("border", "header");
        objects.set("color", "header");
        objects.set("border", "logoBox");
        colorFade(objects);
        var pFade = setInterval(function() {
            // TODO get an API with a list of all the different genres
            // right here, add a part that 
            document.getElementById("genres").placeholder = null
        }, 2000);

        String.prototype.replaceAt=function(index, replacement) {
            return this.substr(0, index) + replacement+ this.substr(index + replacement.length);
        }

        function grabSimilarGenres() {
            var genres = readTextFile("../samples/data/genres.txt");
            console.log(genres);
        }

        function readTextFile(file) {
            var xhr = new XMLHttpRequest();
            if ("withCredentials" in xhr){
                xhr.open("GET", file, true);
            } else if (typeof XDomainRequest != "undefined"){
                console.log("Second one");
                xhr.open("GET", file);
            }
            xhr.onreadystatechange = function () {
                if(xhr.readyState === 4) {
                    if(xhr.status === 200 || xhr.status == 0) {
                        var allText = xhr.responseText;
                        return allText;
                    }
                }
            }
            xhr.send(null);
        }
    </script>
</body>